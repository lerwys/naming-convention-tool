<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- ToDo: split this one into MyRequests and RequestSub -->

<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                template="/WEB-INF/namesTemplate.xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html">

    <ui:define name="content">
        <h:form id="listNcNameForm">

            <!-- ===================Data Table============================ -->
            <p:dataTable id="ncCrTable" var="deviceName" value="#{deviceNamesManager.activeDeviceNames}" paginator="true" rows="50" resizableColumns="true" rowKey="#{deviceName.id}" emptyMessage="There are no active NC Names" selectionMode="single" style="width: 90%">
                <f:facet name="header">
                    <h:outputText value="Active Naming Convention Names" />
                </f:facet>

                <p:ajax event="rowSelect" update=":listNcNameForm:historyTable" listener="#{deviceNamesManager.loadHistory(deviceName.nameId)}" oncomplete="nameDetail.show()" />

                <p:column id="nameString" headerText="Device Name" filterBy="#{deviceName.name}" filterMatchMode="contains" style="width: 20%">
                    <h:outputText value="#{deviceName.name}" />
                </p:column>
                <p:column id="nameSection" headerText="Section" filterBy="#{deviceName.section.fullName}" filterMatchMode="contains" style="width: 15%">
                    <h:outputText value="#{deviceName.section.fullName}" />
                </p:column>
                <p:column id="nameDiscipline" headerText="Device Type" filterBy="#{deviceName.deviceType.fullName}" filterMatchMode="startsWith" style="width: 15%">
                    <h:outputText value="#{deviceName.deviceType.fullName}" />
                </p:column>
                <p:column id="nameStatus" headerText="Status" filterBy="#{deviceName.status}" filterMatchMode="contains">
                    <h:outputText value="#{deviceName.status}" />
                </p:column>

            </p:dataTable>

            <ui:include src="/WEB-INF/includes/nc-dev-history.xhtml" >
                <ui:param name="historyHandler" value="#{deviceNamesManager.historyEvents}" />
            </ui:include>

        </h:form>

    </ui:define>
</ui:composition>